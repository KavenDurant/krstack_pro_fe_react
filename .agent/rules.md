---
description: KRStack Pro Frontend React - AI 协助规则
---

# 项目概述

这是一个基于 React 19 + TypeScript + Vite 的云管理平台前端项目,使用 Ant Design 作为 UI 组件库。

## 技术栈

- React 19.2.0
- TypeScript 5.9.3
- Vite 7.2.2
- Ant Design 6.0.0
- React Router DOM 7.9.6

## 代码规范

- 使用 Prettier 格式化代码(配置见 .prettierrc)
- 使用 ESLint 进行代码检查
- 使用双引号,分号结尾
- 缩进 2 空格
- 最大行宽 80 字符
- 禁止使用 any 类型,必须使用明确的类型或 unknown

## 组件规范

- 使用函数式组件和 Hooks
- 组件文件使用 PascalCase 命名
- 每个页面放在 `src/pages/` 目录下
- 可复用组件放在页面的 `components/` 子目录
- 全局组件放在 `src/components/`

## 样式规范

- 优先使用 Ant Design 组件的内置样式
- 自定义样式使用 inline style 或 CSS 文件
- 避免使用 !important

## Git 工作流

- main 分支受保护,不允许直接推送
- 所有修改必须通过 Pull Request
- 分支命名:feature/功能名, fix/问题名, refactor/重构内容
- Commit 信息格式:type: description (例如: feat: add user login)

## 开发命令

- `npm run dev` - 启动开发服务器
- `npm run build` - 构建生产版本
- `npm run lint` - 运行 ESLint 检查
- `npm run format` - 格式化代码
- `npm run format:check` - 检查代码格式

## AI 协助工作流程

### 复杂需求处理流程

当用户提出复杂需求时,AI 助手应遵循以下流程:

1. **需求分析**
   - 理解需求的核心功能和目标
   - 评估需求的复杂度
   - 识别可能需要的技术方案

2. **技术方案评估**
   - 优先考虑使用成熟的第三方库来实现复杂功能
   - 评估第三方库的优势:稳定性、维护性、社区支持、性能
   - 对比自行实现 vs 使用第三方库的成本和收益

3. **制定实施计划**
   - 列出详细的实施步骤
   - 说明选择特定技术方案的理由
   - 列出需要安装的依赖包及其用途
   - 说明可能的风险和注意事项

4. **等待用户确认**
   - **必须**先向用户展示完整的实施计划
   - **必须**等待用户明确同意后才能开始实施
   - 用户可能会提出修改建议或选择其他方案

5. **开始实施**
   - 仅在用户确认后开始编码
   - 按照计划逐步实施
   - 保持代码质量和项目规范

### 分支管理和提交流程

**每次实现新功能前必须遵循以下流程:**

1. **创建功能分支**
   - 在开始任何新功能开发前,必须先创建新分支
   - 分支命名规范:
     - `feature/功能描述` - 新功能
     - `fix/问题描述` - Bug 修复
     - `refactor/重构内容` - 代码重构
   - 示例:`feature/add-user-management`, `fix/login-error`

2. **在分支上开发**
   - 所有代码修改必须在功能分支上进行
   - 不允许直接在 main 分支上开发
   - 定期提交代码,保持提交历史清晰

3. **完成开发后创建 Pull Request**
   - 功能开发完成后,推送分支到远程仓库
   - 在 GitHub 上创建 Pull Request

4. **编写详细的 PR 描述**

   PR 必须包含以下信息,格式要求简洁明了:

   **Title 格式:**

   ```
   type: 简短描述(不超过 50 字符)
   ```

   **Description 格式:**

   ```markdown
   ## 功能描述

   简要说明本次 PR 实现的功能或修复的问题

   ## 主要变更

   - 变更点 1
   - 变更点 2
   - 变更点 3

   ## 技术方案

   - 使用的技术/库及原因
   - 关键实现思路

   ## 测试

   - [ ] 本地测试通过
   - [ ] 构建无错误
   - [ ] 代码已格式化

   ## 截图(如有 UI 变更)

   [添加截图]

   ## 相关 Issue

   Closes #issue_number (如果有)
   ```

5. **PR 提交检查清单**
   - ✅ 代码已运行 `npm run format` 格式化
   - ✅ 运行 `npm run build` 无错误
   - ✅ 运行 `npm run lint` 无警告
   - ✅ PR 标题和描述清晰完整
   - ✅ 排版简洁,易于阅读

### PR 描述示例

**好的示例:**

```markdown
feat: 添加用户管理页面

## 功能描述

实现用户管理页面,支持用户列表查看、新增、编辑和删除功能

## 主要变更

- 新增 `UserManagement` 页面组件
- 新增 `UserTable` 和 `UserForm` 子组件
- 集成 Ant Design Table 和 Modal 组件
- 添加用户 CRUD 操作的 API 调用

## 技术方案

- 使用 `react-hook-form` 进行表单管理,提升性能
- 使用 Ant Design Table 的分页和筛选功能
- 状态管理使用 React Hooks

## 测试

- [x] 本地测试通过
- [x] 构建无错误
- [x] 代码已格式化
```

**不好的示例:**

```
添加了一些功能
```

### 第三方库选择原则

- 优先选择 React 生态系统中成熟的库
- 考虑库的维护状态(最近更新时间、issue 响应)
- 考虑库的大小和性能影响
- 优先选择 TypeScript 支持良好的库
- 检查与现有依赖的兼容性

### 示例场景

**场景**: 用户需要实现复杂的表单验证

**AI 应该做**:

1. 分析需求:需要哪些验证规则、是否需要异步验证等
2. 推荐方案:使用 `react-hook-form` + `zod` 进行表单管理和验证
3. 说明理由:性能好、TypeScript 支持、易于维护
4. 列出计划:安装依赖、创建验证 schema、集成到表单组件
5. 等待确认后实施

**AI 不应该做**:

- 直接开始编写复杂的自定义验证逻辑
- 在没有说明理由的情况下安装依赖
- 跳过计划直接实施

### 功能测试要求

**每次功能实现完成后,必须进行完整的测试,确保功能正常且不影响现有功能。**

#### 测试范围

AI 助手在完成功能开发后,必须提醒用户进行以下测试:

**1. 前端功能测试**

- **UI 渲染测试**
  - 检查页面是否正常渲染
  - 验证所有组件是否正确显示
  - 测试不同屏幕尺寸下的响应式布局
  - 检查样式是否符合设计要求

- **交互功能测试**
  - 测试所有按钮、链接的点击事件
  - 验证表单输入、验证和提交
  - 测试下拉菜单、弹窗、抽屉等交互组件
  - 检查键盘导航和快捷键(如适用)

- **状态管理测试**
  - 验证组件状态更新是否正确
  - 测试数据在组件间的传递
  - 检查路由跳转和参数传递

- **边界情况测试**
  - 测试空数据状态的显示
  - 测试加载状态的显示
  - 测试错误状态的处理和提示
  - 测试数据量大时的性能表现

**2. 后端集成测试**

- **API 调用测试**
  - 验证 API 请求是否正确发送
  - 检查请求参数格式是否正确
  - 测试 API 响应的正确处理
  - 验证错误响应的处理逻辑

- **数据流测试**
  - 测试数据的增删改查(CRUD)操作
  - 验证数据格式转换是否正确
  - 检查数据验证逻辑
  - 测试数据持久化

- **错误处理测试**
  - 测试网络错误的处理
  - 测试 API 错误响应的处理
  - 验证超时处理
  - 测试权限错误的处理

**3. 跨功能测试**

- **兼容性测试**
  - 测试新功能是否影响现有功能
  - 验证与其他模块的集成
  - 检查是否破坏现有的用户流程

- **性能测试**
  - 检查页面加载速度
  - 测试大数据量下的性能
  - 验证是否有内存泄漏
  - 检查网络请求是否优化

**4. 构建和代码质量测试**

- **构建测试**
  - 运行 `npm run build` 确保无错误
  - 检查构建产物大小是否合理
  - 验证生产环境构建是否正常

- **代码质量检查**
  - 运行 `npm run lint` 确保无警告
  - 运行 `npm run format:check` 确保代码格式正确
  - 检查 TypeScript 类型错误

#### 测试检查清单

AI 助手在提交 PR 前,应确保以下测试都已完成:

```markdown
## 测试检查清单

### 前端测试

- [ ] UI 正常渲染,无样式错误
- [ ] 所有交互功能正常工作
- [ ] 表单验证和提交正常
- [ ] 响应式布局在不同屏幕下正常
- [ ] 空数据、加载、错误状态显示正确

### 后端集成测试

- [ ] API 调用成功,数据正确返回
- [ ] CRUD 操作正常工作
- [ ] 错误处理正确,有友好的错误提示
- [ ] 网络异常情况处理正确

### 兼容性测试

- [ ] 新功能不影响现有功能
- [ ] 与其他模块集成正常
- [ ] 用户流程完整无中断

### 代码质量

- [ ] `npm run build` 无错误
- [ ] `npm run lint` 无警告
- [ ] `npm run format:check` 通过
- [ ] TypeScript 无类型错误

### 浏览器测试

- [ ] Chrome 测试通过
- [ ] 其他主流浏览器测试(如EDGE)
```

#### 测试失败处理

如果测试发现问题:

1. **记录问题**
   - 详细描述问题现象
   - 记录复现步骤
   - 截图或录屏保存证据

2. **分析原因**
   - 定位问题代码
   - 分析根本原因
   - 评估影响范围

3. **修复问题**
   - 在同一分支上修复
   - 重新测试验证
   - 更新 PR 描述说明修复内容

4. **回归测试**
   - 重新执行完整测试流程
   - 确保修复没有引入新问题

#### AI 助手的测试职责

- **提醒测试**: 功能完成后,明确提醒用户进行完整测试
- **提供测试指导**: 列出需要测试的具体项目
- **协助问题定位**: 如果测试发现问题,协助分析和修复
- **确保质量**: 不要跳过测试直接提交 PR

## 注意事项

- 所有新功能需要在功能分支开发
- 提交前运行 `npm run format` 格式化代码
- 确保 `npm run build` 无错误
- PR 需要解决所有评论才能合并
